{% extends "base.html" %}
{% block title %}Analytics | Layup List{% endblock %}
{% block content %}
{% load admin_urls %}
<div class="row">
    <div class="col-md-12">
        <h1> Analytics </h1>
        <p> {{ activated_accounts }} users are activated. </p>
        <p> <a href="{% url 'sentiment_labeler' %}">Sentiment Labeler</a>
        <table class="table">
            <thead>
                <th>Range</th>
                <th><a href="/admin/auth/user/?is_active__exact=1">Users</a></th>
                <th>Good Votes</th>
                <th>Layup Votes</th>
                <th><a href="/admin/web/review/">Reviews</a></th>
            </thead>
            <tbody>
                {% for c1, c2, c3, c4, c5 in overall_table %}
                <tr>
                    <th>{{ c1}}</th>
                    <td>{{ c2 }}</td>
                    <td>{{ c3 }}</td>
                    <td>{{ c4 }}</td>
                    <td>{{ c5 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <h3>Recommendations</h3>
        <p><a href="/eligible_for_recommendations/">View users eligible for recommendations.</a></p>
        <ul>
            {% for rec_type, updated in recommendations_last_updated %}
            <li>{{ rec_type }} last updated {{ updated }}</li>
            {% endfor %}
        </ul>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <h3>Vote Breakdown</h3>
        <table class="table">
            <thead>
                <th>Range</th>
                <th>Good +</th>
                <th>Good -</th>
                <th>Layup +</th>
                <th>Layup -</th>
                <th>Total Unvotes</th>
            </thead>
            <tbody>
                {% for c1, c2, c3, c4, c5, c6 in vote_table %}
                <tr>
                    <th>{{ c1}}</th>
                    <td>{{ c2 }}</td>
                    <td>{{ c3 }}</td>
                    <td>{{ c4 }}</td>
                    <td>{{ c5 }}</td>
                    <td>{{ c6 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <h3>Class Breakdown</h3>
        <table class="table">
            <thead>
                <th>Class Year</th>
                {% for year, count in class_breakdown %}
                    <th><a href="/admin/auth/user/?q=.{{ year }}&is_active__exact=1">{{ year }}</a></th>
                {% endfor %}
            </thead>
            <tbody>
                <tr>
                    <th># Users</th>
                    {% for year, count in class_breakdown %}
                        <td>{{ count }}</td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-md-3">
        <h4>Most Votes</h4>
        <p> {{ num_voters }} voters </p>
        <ol>
        {% for user, vote_count in high_voters %}
            <li>{{ vote_count }} (<a href="/admin/auth/user/{{ user }}">#{{ user }}</a>)</li>
        {% endfor %}
        </ol>
    </div>
    <div class="col-md-3">
        <h4>Most Good Votes</h4>
        <p> {{ num_good_voters }} good voters </p>
        <ol>
        {% for user, vote_count in high_good_voters %}
            <li>{{ vote_count }} (<a href="/admin/auth/user/{{ user }}">#{{ user }}</a>)</li>
        {% endfor %}
        </ol>
    </div>
    <div class="col-md-3">
        <h4>Most Layup Votes</h4>
        <p> {{ num_layup_voters }} layup voters </p>
        <ol>
        {% for user, vote_count in high_layup_voters %}
            <li>{{ vote_count }} (<a href="/admin/auth/user/{{ user }}">#{{ user }}</a>)</li>
        {% endfor %}
        </ol>
    </div>
    <div class="col-md-3">
        <h4>Top Reviewers</h4>
        <p> {{ num_reviewers }} reviewers </p>
        <ol>
        {% for user, review_count in top_reviewers %}
            <li>{{ review_count }} (<a href="/admin/auth/user/{{ user }}">#{{ user }}</a>)</li>
        {% endfor %}
        </ol>
    </div>
</div>

{% endblock %}
